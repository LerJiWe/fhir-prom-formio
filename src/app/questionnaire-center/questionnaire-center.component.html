<div class="tab-container">
    <div class="tabs">
        <button class="tab-btn" [class.active]="activeTab === 'search'" (click)="activeTab = 'search'">
            問卷查詢清單
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'render'" (click)="activeTab = 'render'">
            表單渲染
        </button>
    </div>

    <div class="tab-content">
        <div *ngIf="activeTab === 'search'">
            <div class="q-container">
                <div class="search-toolbar">
                    <input type="text" [(ngModel)]="searchTitle" placeholder="搜尋問卷標題..." class="search-input">
                    <div class="date-group">
                        <label>發布區間：</label>
                        <input type="date" [(ngModel)]="dateStart" class="input-date">
                        <span>至</span>
                        <input type="date" [(ngModel)]="dateEnd" class="input-date">
                    </div>
                    <select [(ngModel)]="searchStatus" class="search-select">
                        <option value="active">僅顯示啟用 (Active)</option>
                        <option value="retired">已停用 (Retired)</option>
                        <option value="all">全部狀態</option>
                    </select>
                    <button (click)="onSearch()" class="btn-search">搜尋</button>
                </div>

                <table class="q-table">
                    <thead>
                        <tr>
                            <th>標題 (Title)</th>
                            <th>版本 (Ver.)</th>
                            <th>狀態 (Status)</th>
                            <th>發布者 (Publisher)</th>
                            <th>發布日期 (Date)</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let q of questionnaireList">
                            <td><strong>{{ q.title }}</strong></td>
                            <td>{{ q.version }}</td>
                            <td><span [class]="'badge-' + q.status">{{ q.status }}</span></td>
                            <td>{{ q.publisher }}</td>
                            <td>{{ q.date | date:'yyyy-MM-dd' }}</td>
                            <td>
                                <button (click)="selectQuestionnaire(q.id)" class="btn-action">選擇此問卷</button>
                            </td>
                        </tr>
                        <tr *ngIf="questionnaireList.length === 0">
                            <td colspan="6" style="text-align: center;">查無問卷資料</td>
                        </tr>
                    </tbody>
                </table>

                <div class="pagination-footer" *ngIf="nextUrl">
                    <button (click)="loadNextPage()" class="btn-next">載入更多問卷 (下一頁)</button>
                </div>
            </div>

        </div>

        <div *ngIf="activeTab === 'render'">
            <div class="placeholder-box">
                <h3>Form.io 渲染區域</h3>
                <p>當 IR 轉換完成後，表單將在此顯示。</p>
                <div *ngIf="tmpl">
                    <formio [form]="tmpl" [refresh]="triggerRefresh"></formio>
                </div>
            </div>
        </div>
    </div>
</div>